import{c as u,b as L,a as c,S as A,d as O,j as e,m as y}from"./index-DxDjdAZm.js";import{C as D,A as M,S as C,X as E}from"./input-CHc0xvdJ.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Y=u("arrow-left",z);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],S=u("bot",F);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],P=u("log-out",H);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],B=u("menu",I);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],V=u("message-circle",T);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],W=u("trash-2",q);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ee=u("triangle-alert",G);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],j=u("user",X),_="/assets/prelude%20logo%20transparent-Cm9rtBSe.png",l={roles:{admin:{description:"Full access to all features and tabs",permissions:["leads","sales-center","crm","deals","usage-analytics","user-onboarding"]},manager:{description:"Full access to all features and tabs",permissions:["leads","sales-center","crm","deals","usage-analytics","user-onboarding"]},employee:{description:"Full access to all features and tabs",permissions:["leads","sales-center","crm","deals","usage-analytics","user-onboarding"]}},user_roles:{"mark.li@preludeos.com":"admin","admin@prelude.com":"admin","ceo@prelude.com":"admin","founder@prelude.com":"admin","system@prelude.com":"admin","aoxue@preludeos.com":"admin","benjamin@preludeos.com":"admin","bohan@preludeos.com":"admin","bolin@preludeos.com":"admin","james@preludeos.com":"admin","prelude@preludeos.com":"admin","vincent@preludeos.com":"admin","mark@preludeos.com":"admin","mark.hoshipu@example.com":"admin","manager@prelude.com":"manager","sales.manager@prelude.com":"manager","team.lead@prelude.com":"manager","supervisor@prelude.com":"manager","sarah.manager@prelude.com":"manager","employee@prelude.com":"employee","user@prelude.com":"employee","sales@prelude.com":"employee","support@prelude.com":"employee","developer@prelude.com":"employee","john.doe@prelude.com":"employee"},role_mapping:{Admin:"admin",Administrator:"admin","Project Manager":"manager",Manager:"manager",Developer:"employee",Employee:"employee",User:"employee"},default_role:"admin",available_tabs:{dashboard:{name:"Dashboard",icon:"LayoutDashboard",description:"Overview of metrics, tasks & AI agents"},calendar:{name:"Calendar",icon:"Calendar",description:"Schedule and meeting management"},leads:{name:"Lead Generation",icon:"Target",description:"Lead generation and management"},employees:{name:"Employee Profiles",icon:"Users",description:"Employee management and profiles"},"sales-center":{name:"Sales Center",icon:"BarChart2",description:"Sales analytics and reports"},crm:{name:"CRM",icon:"UserCheck",description:"Customer relationship management"},deals:{name:"Deals",icon:"DollarSign",description:"Deal pipeline & management"},"usage-analytics":{name:"Usage Analytics",icon:"BarChart2",description:"System usage and performance analytics"},"user-onboarding":{name:"User Onboarding",icon:"UserPlus",description:"Manage team organization and personal onboarding"}}},Z=async a=>{try{console.log(`Fetching user role from database for email: ${a}`);const r=await A.getUserInvitations(a);if(r.user&&r.user.role){const s=r.user.role,i=l.role_mapping[s]||l.default_role;return console.log(`Database role: ${s} -> System role: ${i}`),{systemRole:i,userProfile:r.user}}else return console.log(`User ${a} not found in database, using fallback`),{systemRole:null,userProfile:null}}catch(r){return console.error("Error fetching user role from database:",r),{systemRole:null,userProfile:null}}},J=()=>{const{user:a,isAuthenticated:r}=L(),[s,i]=c.useState({userRole:null,userProfile:null,isLoading:!0,roleSource:"hardcoded"});c.useEffect(()=>{if(r===null)return;(async()=>{if(r&&(a!=null&&a.email)){const o=a.email.toLowerCase();try{const{systemRole:m,userProfile:h}=await Z(o);if(m)i({userRole:m,userProfile:h,roleSource:"database",isLoading:!1}),console.log(`User role from database: ${m} for email: ${o}`);else{const b=l.user_roles[o]||l.default_role;i({userRole:b,userProfile:null,roleSource:"hardcoded",isLoading:!1}),console.log(`User role from hardcoded: ${b} for email: ${o}`)}}catch(m){console.warn("Database role fetch failed, using hardcoded roles:",m);const h=l.user_roles[o]||l.default_role;i({userRole:h,userProfile:null,roleSource:"hardcoded",isLoading:!1}),console.log(`User role from hardcoded (fallback): ${h} for email: ${o}`)}}else i({userRole:null,userProfile:null,roleSource:"hardcoded",isLoading:!1})})()},[r,a==null?void 0:a.email]);const p=c.useMemo(()=>!s.userRole||!l.roles[s.userRole]?[]:l.roles[s.userRole].permissions||[],[s.userRole]),g=c.useMemo(()=>!s.userRole||!l.roles[s.userRole]?"":l.roles[s.userRole].description||"",[s.userRole]),d=n=>!r||!s.userRole?!1:p.includes(n),f=c.useMemo(()=>!r||!s.userRole?[]:Object.entries(l.available_tabs).filter(([n])=>d(n)).map(([n,o])=>({id:n,...o})),[r,s.userRole,p]),x=n=>!r||!s.userRole?[]:n.filter(o=>d(o.id)),t=s.userRole==="admin",N=s.userRole==="admin"||s.userRole==="manager",v=(n=>({employee:1,manager:2,admin:3})[n]||0)(s.userRole);return{userRole:s.userRole,roleDescription:g,permissions:p,rolePriority:v,isLoading:s.isLoading,userProfile:s.userProfile,roleSource:s.roleSource,hasPermission:d,isAdmin:t,isManager:N,availableTabs:f,getFilteredNavItems:x,roleConfig:l,userEmail:(a==null?void 0:a.email)||null,isAuthenticated:r}},se=({isChatVisible:a,onToggleChatVisibility:r,isWsConnected:s,loadingEnabled:i,onToggleLoading:p})=>{const[g,d]=c.useState(!1),[f,x]=c.useState(!1),{user:t,logout:N,isAuthenticated:w}=L(),{userRole:v}=J(),n=O(),o=c.useRef(null);c.useEffect(()=>{const R=U=>{o.current&&!o.current.contains(U.target)&&x(!1)};return document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[]);const m=()=>{N(),d(!1),x(!1)},h=()=>{d(!g)},b=()=>{n("/settings"),x(!1),d(!1)},k=()=>{console.log("Navigation: Profiles button clicked"),console.log("Navigation: Current user:",t),console.log("Navigation: Navigating to /profiles"),n("/profiles"),x(!1),d(!1)},$=()=>{x(!f)};return e.jsx("nav",{className:"navigation-bar w-full",role:"navigation","aria-label":"Main navigation",style:{backgroundColor:"rgb(225, 239, 242)"},children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 sm:px-8 lg:px-10",children:[e.jsxs("div",{className:"flex justify-center items-center h-20",children:[e.jsx("div",{className:"hidden lg:flex items-center space-x-6",children:w&&e.jsxs(e.Fragment,{children:[e.jsxs(y.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.6,delay:.05},className:"flex items-center space-x-3 rounded-lg px-4 py-3 text-gray-800",children:[e.jsx("img",{src:_,alt:"Prelude Logo",className:"h-[145px] w-auto"}),e.jsx(S,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-semibold",children:"AI Assistant"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-green-600",children:"Online & Ready"})]})]})]}),e.jsxs(y.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.6,delay:.15},className:"flex items-center space-x-4 rounded-lg px-4 py-3 text-gray-800",children:[e.jsxs("div",{className:"flex flex-col text-right",children:[e.jsx("span",{className:"text-sm font-semibold",children:(t==null?void 0:t.email)||"user@example.com"}),e.jsxs("span",{className:"text-xs text-gray-600",children:[v||"User"," • Level 1"]})]}),t!=null&&t.picture?e.jsx("img",{src:t.picture,alt:"Profile",className:"h-10 w-10 rounded-full border-2 border-white/30"}):e.jsx("div",{className:"h-10 w-10 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx(j,{className:"h-5 w-5 text-gray-600"})})]}),e.jsxs("div",{className:"relative",ref:o,children:[e.jsx(y.button,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},onClick:$,className:"flex items-center justify-center w-12 h-12 text-gray-800 hover:text-gray-900 transition-colors rounded-lg hover:bg-cyan-200",title:"User Menu",children:e.jsx(D,{className:`h-5 w-5 transition-transform ${f?"rotate-180":""}`})}),e.jsx(M,{children:f&&e.jsx(y.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute right-0 mt-2 w-52 bg-white rounded-lg shadow-xl border py-2 z-50",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:k,className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(j,{className:"h-4 w-4 mr-3 text-gray-500"}),"Profiles"]}),e.jsxs("button",{onClick:b,className:"flex items-center w-full px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(C,{className:"h-4 w-4 mr-3 text-gray-500"}),"Settings"]}),e.jsx("div",{className:"border-t border-gray-100 my-1"}),e.jsxs("button",{onClick:m,className:"flex items-center w-full px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors",children:[e.jsx(P,{className:"h-4 w-4 mr-3"}),"Sign Out"]})]})})})]})]})}),e.jsx("div",{className:"lg:hidden",children:w&&e.jsx(y.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.6},onClick:h,className:"text-gray-800 hover:text-gray-900 transition-colors p-3 rounded-md hover:bg-cyan-200","aria-label":g?"Close menu":"Open menu",children:g?e.jsx(E,{className:"h-7 w-7"}):e.jsx(B,{className:"h-7 w-7"})})})]}),e.jsx(M,{children:g&&e.jsx(y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"lg:hidden border-t overflow-hidden",style:{backgroundColor:"rgb(225, 239, 242)"},children:e.jsxs("div",{className:"px-6 pt-6 pb-8 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 pb-3 text-gray-800",children:[e.jsx("img",{src:_,alt:"Prelude Logo",className:"h-8 w-8 object-contain"}),e.jsx(S,{className:"h-6 w-6 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800 font-inter text-base",children:"AI Assistant"}),e.jsx("div",{className:"text-sm text-green-600 font-inter",children:"Online & Ready"})]})]}),e.jsxs("button",{onClick:r,className:`flex items-center space-x-4 w-full text-left px-4 py-4 rounded-lg transition-all duration-300 ${a?"bg-cyan-200 text-gray-800":"text-gray-800 hover:bg-cyan-200"}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"h-6 w-6"}),s&&e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-400 rounded-full animate-pulse"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-base",children:a?"Hide Chat":"Show Chat"}),e.jsx("div",{className:"text-sm text-gray-600",children:s?"Connected":"Disconnected"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 pb-4 border-b border-cyan-200 text-gray-800",children:[t!=null&&t.picture?e.jsx("img",{src:t.picture,alt:"Profile",className:"h-12 w-12 rounded-full border-2 border-white/30"}):e.jsx("div",{className:"h-12 w-12 rounded-full bg-white/20 flex items-center justify-center",children:e.jsx(j,{className:"h-6 w-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-800 font-inter text-base",children:(t==null?void 0:t.email)||"user@example.com"}),e.jsxs("div",{className:"text-sm text-gray-600 font-inter",children:[v||"User"," • Level 1"]})]})]}),e.jsxs("button",{onClick:k,className:"flex items-center space-x-3 w-full text-left px-4 py-3 rounded-md text-gray-800 hover:text-gray-900 hover:bg-cyan-200 transition-colors font-inter text-base",children:[e.jsx(j,{className:"h-5 w-5"}),e.jsx("span",{children:"Profiles"})]}),e.jsxs("button",{onClick:b,className:"flex items-center space-x-3 w-full text-left px-4 py-3 rounded-md text-gray-800 hover:text-gray-900 hover:bg-cyan-200 transition-colors font-inter text-base",children:[e.jsx(C,{className:"h-5 w-5"}),e.jsx("span",{children:"Settings"})]}),e.jsxs("button",{onClick:m,className:"flex items-center space-x-3 w-full text-left px-4 py-3 rounded-md text-red-600 hover:text-red-700 hover:bg-red-100 transition-colors font-inter text-base",children:[e.jsx(P,{className:"h-5 w-5"}),e.jsx("span",{children:"Sign Out"})]})]})})})]})})},ae=({children:a,className:r="",gradientFrom:s="gray-50",gradientVia:i="white",gradientTo:p="gray-50"})=>e.jsxs("div",{className:`relative min-h-screen overflow-hidden bg-gradient-to-br from-${s} via-${i} to-${p} ${r}`,children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.02]",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle at 1px 1px, rgba(0,0,0,0.15) 1px, transparent 0)",backgroundSize:"40px 40px"}})}),e.jsx("div",{className:"relative z-10",children:a})]});export{Y as A,S as B,P as L,V as M,se as N,ee as T,j as U,W as a,ae as b,_ as l,J as u};
